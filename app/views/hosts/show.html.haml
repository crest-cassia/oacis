.page-header
  %h1= "Host: #{@host.name}"

%table.table.table-striped
  %thead
  %tbody
    %tr
      %th Name
      %td= @host.name
    %tr
      %th Hostname
      %td= @host.hostname
    %tr
      %th User
      %td= @host.user
    %tr
      %th Port
      %td= @host.port
    %tr
      %th SSH key
      %td= @host.ssh_key
    %tr
      %th Scheduler type
      %td= @host.scheduler_type
    %tr
      %th Work base directory
      %td= @host.work_base_dir
    %tr
      %th Maximum number of jobs
      %td= @host.max_num_jobs
    %tr
      %th MPI procs
      %td
        - if @host.min_mpi_procs == @host.max_mpi_procs
          = @host.min_mpi_procs
        - else
          = "#{@host.min_mpi_procs} ~ #{@host.max_mpi_procs}"
    %tr
      %th OMP threads
      %td
        - if @host.min_omp_threads == @host.max_omp_threads
          = @host.min_omp_threads
        - else
          = "#{@host.min_omp_threads} ~ #{@host.max_omp_threads}"
    %tr
      %th Template
      %td
        %pre= @host.template
    %tr
      %th Host Parameters
      %td
        %table.table.table-striped
          %thead
            %th Name
            %th Default
            %th Format
          %tbody
            - @host.host_parameter_definitions.each do |host_prm|
              %tr
                %td= host_prm.key
                %td= host_prm.default
                %td= host_prm.format
    %tr
      %th Executable simulators
      %td= raw( @host.executable_simulators.map {|sim| h(sim.name) }.join('<br />') )

.form-actions
  = link_to 'Edit', edit_host_path(@host), class: 'btn btn-info'
  = link_to 'Back to Index', hosts_path, class: 'btn'
  = link_to 'Destroy', @host, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-warning' if @host.destroyable?

%hr
%h3 Host Status

%table.table.table-striped{style: "table-layout: fixed;"}
  %thead
    %tr
      %th Total
      %th
        Finished : 
        = raw(status_label(:finished))
      %th
        Failed : 
        = raw(status_label(:failed))
      %th
        Running : 
        = raw(status_label(:running))
      %th
        Submitted : 
        = raw(status_label(:submitted))
      %th
        Created : 
        = raw(status_label(:created))
  %tbody
    %tr
      - stat_count = @host.runs_status_count
      - total = stat_count.reject {|status| status == :cancelled}.values.inject(:+)
      %th= total
      %td= "#{stat_count[:finished]} (#{(100.0*stat_count[:finished]/total.to_f).round(1)} %)"
      %td= "#{stat_count[:failed]} (#{(100.0*stat_count[:failed]/total.to_f).round(1)} %)"
      %td= "#{stat_count[:running]} (#{(100.0*stat_count[:running]/total.to_f).round(1)} %)"
      %td= "#{stat_count[:submitted]} (#{(100.0*stat_count[:submitted]/total.to_f).round(1)} %)"
      %td= "#{stat_count[:created]} (#{(100.0*stat_count[:created]/total.to_f).round(1)} %)"

%pre= @status
