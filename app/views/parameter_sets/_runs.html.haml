- param_string = parameter_set.v.map {|key,val| "#{key}=#{val}" }.join(', ')
%h3= "Runs on (#{param_string})"

%table.table.table-condensed.table-hover.table-striped#runs_list{:'data-source' => "#{_runs_list_parameter_set_path(parameter_set.to_param, format: "json")}"}
  %thead
    %tr
      - RunsListDatatable::HEADER.each do |header|
        = raw(header)
  %tbody

- unless OACIS_READ_ONLY
  %h3 Create New Runs
  - run = parameter_set.runs.build(submitted_to: parameter_set.simulator.executable_on.first)
  = form_for( [parameter_set, run], html: {class: 'form-horizontal', remote: true}) do |f|
    #run_form_messages
    .form-group
      = label_tag('num_runs', '# of Runs', class: 'col-md-2 control-label')
      .col-md-3
        = select_tag('num_runs', options_for_select([1,2,3,4,5,10,20]), {class: 'form-control'})
    = render 'runs/fields', run: run, f: f
    .form-group
      .col-md-4.col-md-offset-2
        = submit_tag 'Preview', name: 'preview_button', class: 'btn', remote: true
        = f.submit(class: 'btn btn-primary')
  #script_preview_modal.modal.large.fade
    .modal-dialog.modal-vertical-centered
      .modal-content
        .modal-header
          %button.close{type: "button", "data-dismiss" => "modal"}
            &times;
          %h4.modal-title
            Job Script Preview
        .modal-body.large#script_preview
        .modal-footer
          %button.btn.btn-default{type: "button", "data-dismiss" => "modal"}
            Close

:javascript
  $(function() {
    var oRunsTable = datatables_for_runs_table();
    if( window.bEnableAutoReload ) {
      setInterval( function() {
        if( $("#tab-list-runs").length > 0 ) { // Runs tab in ParameterSet show page
          if( $("#tab-list-runs")[0].classList.contains("active") ) {
            var id_list = $('.dataTable input:checked').map(function() {
               return $(this).val();
            }).get();
            oRunsTable.ajax.reload( function(){
              for(var i=0; i<id_list.length; i++){
                $('input[value='+ id_list[i] +']').prop('checked', true);
                if(i == id_list.length-1) $('input[value='+ id_list[i] +']').prop('checked', true).trigger('change');
              }
            }, false);
          }
        }
      }, 5000);
    }
  });
