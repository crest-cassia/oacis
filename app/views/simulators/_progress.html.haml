%h3 Number of Runs

%table.table.table-striped{style: "table-layout: fixed;"}
  %thead
    %tr
      %th Total
      %th
        Finished : 
        = raw(status_label(:finished))
      %th
        Failed : 
        = raw(status_label(:failed))
      %th
        Running : 
        = raw(status_label(:running))
      %th
        Submitted : 
        = raw(status_label(:submitted))
      %th
        Created : 
        = raw(status_label(:created))
  %tbody
    %tr
      - stat_count = @simulator.runs_status_count
      - total = stat_count.reject {|status| status == :cancelled}.values.inject(:+)
      %th= total
      %td= "#{stat_count[:finished]} (#{(100.0*stat_count[:finished]/total.to_f).round(1)} %)"
      %td= "#{stat_count[:failed]} (#{(100.0*stat_count[:failed]/total.to_f).round(1)} %)"
      %td= "#{stat_count[:running]} (#{(100.0*stat_count[:running]/total.to_f).round(1)} %)"
      %td= "#{stat_count[:submitted]} (#{(100.0*stat_count[:submitted]/total.to_f).round(1)} %)"
      %td= "#{stat_count[:created]} (#{(100.0*stat_count[:created]/total.to_f).round(1)} %)"

%h3 Progress overview

%div
  .row
    .span8#progress-overview
      %svg
      #progress-tooltip.progress-tooltip{style: "opacity: 0;"}
    .span4
      %aside
        %p
          Progress each parameter set:
          %br
          0%-------------100%
          %br
          %svg#colormap-svg
        #color-map
        :javascript
          draw_color_map();
        %form.form-horizontal
        - parameter_keys = @simulator.parameter_definitions.map(&:key)
        .control-group
          %label Column Parameter:
          .controls
            = select_tag 'column_parameter', options_for_select(parameter_keys, selected: parameter_keys[0]), id: 'column_parameter';
        .control-group
          %label Row Parameter:
          .controls
            = select_tag 'row_parameter', options_for_select(parameter_keys, selected: parameter_keys[1]), id: 'row_parameter'
        = submit_tag 'Show', name: 'show_progress_button', class: 'btn btn-primary', id: 'show_progress_button'
:javascript
  var url = "#{_progress_simulator_path}" + ".json";
  $('#show_progress_button').on('click', function () {
    var cp = $('#column_parameter option:selected').val();
    var rp = $('#row_parameter option:selected').val();
    var url_with_param = url + "?row_parameter=" + rp + "&column_parameter=" + cp;
    draw_progress_overview(url_with_param);
  })
