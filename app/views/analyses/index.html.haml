.page-header
  %h1 Analyses

%h3 Running Analyses
%table.table.table-condensed.table-hover.table-striped.analyses_datatable{:'data-source' => "#{_analyses_table_analyses_path(format: "json", analysis_status: "running")}"}
  %thead
    %tr
      - AnalysesListDatatable::HEADER.each do |header|
        = raw(header)
  %tbody

%hr
%h3 Created Analyses
%table.table.table-condensed.table-hover.table-striped.analyses_datatable{:'data-source' => "#{_analyses_table_analyses_path(format: "json", analysis_status: "created")}"}
  %thead
    %tr
      - AnalysesListDatatable::HEADER.each do |header|
        = raw(header)
  %tbody

:javascript
  $(function() {
    var aoAnalysesTables = []
    $('.analyses_datatable').each( function() {
      var source = $(this).attr("data-source");
      var oTable = $(this).DataTable({
        processing: true,
        serverSide: true,
        searching: false,
        ajax: source
      });
      aoAnalysesTables.push(oTable);
    });
    aoAnalysesTables.forEach( function(oTable) {
      setInterval( function() {
        var num_open = $('img.treebtn[state="open"]', $(oTable)).length;
        if( num_open == 0 ) { oTable.ajax.reload(null, false); }
      }, 5000);
      $('.dataTables_length', $(oTable).parent()).append(
        '<i class="fa fa-refresh padding-8 clickable" id="analyses_list_refresh"></i>'
      );
      $('#analyses_list_refresh', $(oTable).parent()).on('click', function() {
        oTable.ajax.reload(null, false);
      });
    });
  });
